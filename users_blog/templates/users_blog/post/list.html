{% extends 'users_blog/base.html' %} <!-- This way, this html file will inherit from the parent page/template (base.html). -->

{% load blog_tags %} <!-- Loading custom template tags/filters. -->

{% block title%}My Blog{% endblock %}

{% block content %}
    <h1>My blog</h1>

    <!-- ####################################################################################################### -->

    <!-- For detecting tags. -->
    {% if tag %}
        <h2>Posts tagged with "{{tag.name}}"</h2>
    {% endif %}

    <!-- ####################################################################################################### -->

    {% for post in posts %}
        <h2><a href="{{ post.get_absolute_url }}" target="_blank">{{ post.title }}</a></h2> <!-- The title from the respective post will be a link
        to the canonical URL of this post. -->

        <!-- ####################################################################################################### -->

        <!-- Displaying the tags for every post (if any has at least one). -->
        
        <!-- <p class="tags">Tags: {{post.tags.all|join:", "}}</p> -->
        
        <!-- Looping through all the tags of a post displaying a custom link to the URL to filter posts by that tag: -->
        <p class="tags">
        Tags: {% for tag in post.tags.all %}
                <a href="{% url 'users_blog:post_list_by_tag' tag.slug %}">{{tag.name}}</a>
                {% if not forloop.last %},{% endif %}
                {% endfor %}
        </p>

        <!-- ####################################################################################################### -->

        <p class="date">Published {{ post.publish }} by {{ post.author }}</p>
        <!-- {{ post.body|truncatewords:30|linebreaks }} # This is a TEMPLATE FILTER. We've truncated the body from our post up to 30 words and 
        we tell django to show the "enters (from the keyboard)". WE CAN CONCATENATE AS MAY FILTERS AS WE WISH; each one will be applied to the 
        preceding output generated by the preceding one. -->

        {{ post.body|markdown|truncatewords_html:30 }} <!-- The "truncatewords_html" filter truncates a string after a certain number of words,
        avoiding unclosed HTML tags. -->

    {% endfor %}
    <!--{째|째 include "../pagination.html" with page=posts 째|째}--> <!-- We are including pagination.html directly inside list.html. This mean, we don't
    need to declare this directly inside the local "url.py" file. (This goes for the FBV "def post_list(request)"). -->
    
    <!-- {% include "../pagination.html" with page=page_obj %}  # Since ListView passes the selected page in a variable called "page_obj". -->

    {% include "../pagination.html" with page=posts %} <!-- Since we are using "post_list" view instead of "PostListView". -->
    
{% endblock %}